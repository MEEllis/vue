webpackJsonp([16],{1514:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a(30),r=a(566),n=(a(139),a(1646)),s=function(e){return e&&e.__esModule?e:{default:e}}(n),o=a(324),i=function(e){return e.stockList.getStockListResult||[]},u=(0,r.createSelector)([i],function(e){return!!e.Data&&e}),c=function(e,t){return{getStockListResult:u(e),createStockResult:e.stockList.createStockResult,isfetching:!!e.stockList.isfetching}};t.default=(0,l.connect)(c,{getStockList:o.getStockList,createStock:o.createStock})(s.default),e.exports=t.default},1554:function(e,t,a){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=(a(216),a(172)),r=_interopRequireDefault(l),n=a(0),s=_interopRequireDefault(n),o=a(59),i=_interopRequireDefault(o);a(213),a(1557);var u=s.default.createClass({displayName:"IconComponent",getInitialState:function(){return{title:this.props.title}},show:function(){this.setState({title:"尚未开通该权限，请联系管理员"})},onMouseLeave:function(){var e=this;setTimeout(function(){e.setState({title:e.props.title})},200)},render:function(){var e=this.props,t=e.title,a=e.click,l=e.glyphIcon,n=e.disabled;return s.default.createElement("div",{className:"IconCompont"},n?s.default.createElement(r.default,{title:t,arrowPointAtCenter:!0,onMouseLeave:this.onMouseLeave},s.default.createElement("span",{className:"disabled",onClick:this.show},s.default.createElement(i.default,{glyph:l}))):s.default.createElement(r.default,{title:t,arrowPointAtCenter:!0},s.default.createElement("a",{href:"javascript:;",onClick:a},s.default.createElement(i.default,{glyph:l}))))}});t.default=u,e.exports=t.default},1557:function(e,t){},1646:function(e,t,a){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=(a(114),a(113)),r=_interopRequireDefault(l),n=(a(565),a(564)),s=_interopRequireDefault(n),o=(a(169),a(168)),i=_interopRequireDefault(o),u=(a(167),a(166)),c=_interopRequireDefault(u),f=(a(171),a(170)),d=_interopRequireDefault(f),p=(a(112),a(165)),m=_interopRequireDefault(p),h=(a(563),a(320)),k=_interopRequireDefault(h),g=(a(78),a(77)),y=_interopRequireDefault(g),S=(a(67),a(60)),b=_interopRequireDefault(S),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},C=function(){function defineProperties(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),E=a(0),R=_interopRequireDefault(E),w=a(31),D=a(59);_interopRequireDefault(D);a(213);var _=a(1554),P=_interopRequireDefault(_),I=(b.default.Group,y.default.Item),T=k.default.Option,L=(m.default.Group,y.default.create),q=function(e){function StockAdd(e){_classCallCheck(this,StockAdd);var t=_possibleConstructorReturn(this,(StockAdd.__proto__||Object.getPrototypeOf(StockAdd)).call(this,e));return t.handleSelectChange=function(e){var a=[];switch(e){case"1":a=["卡密","在线"];break;case"2":t.props.getStockList(t.state.PostData),t.setState({reload:!0}),a=["卡密"];break;case"3":a=["在线"]}t.setState({stockType:a,stockTypeVal:a[0]})},t.removeSetClass=function(e,a){var l=t.state.selectedRowDatas,r=t.state.selectedRowKeys;for(var n in l)if(l[n].Id==a){l.splice(n,1),r.splice(n,1);break}t.setState({selectedRowDatas:l,selectedRowKeys:r})},t.setClass=function(e,a){var l=t.state.selectedRowDatas;for(var r in l)if(l[r].Id==a){l[r].priority=e.target.value;break}t.setState({selectedRowDatas:l})},t.handleSelectStockTypeValChange=function(e){t.setState({stockTypeVal:e})},t.sibmitData=function(){t.props.form.validateFields(function(e,a){if(e)return!1;var l={relationStocks:[]};if(Object.assign(l,a),2==l.Nature){Object.assign(l.relationStocks,t.state.selectedRowDatas);var r=l.relationStocks;if(0===r.length)return d.default.success("请选择关联库存"),!1;if(r.length<2)return d.default.success("请选择2个以上的库存"),!1;var n={};for(var s in r){if(!Number.isInteger(Number(r[s].priority)))return d.default.success("出库优先级必须为大于0的整数"),!1;if(n[r[s].priority])return d.default.success("出库优先级不能重复"),!1;n[r[s].priority]=!0}l.FaceValue=1,l.WarningCount=0}for(var o in l.relationStocks)l.relationStocks[o].relationId=l.relationStocks[o].Id;t.props.createStock(l),t.setState({reload:!0})})},t.selectStock=function(){t.props.form.validateFields(function(e,a){t.state.PostData.name=a.selectStockName,t.props.getStockList(t.state.PostData),t.setState({reload:!0})})},t.displayAllStock=function(){var e=t.state.PostData;e.name="",t.props.getStockList(e),t.setState({reload:!0,PostData:v({},e,{name:""})})},t.state={stockType:["卡密","在线"],stockTypeVal:"卡密",selectedRowKeys:"",selectedRows:[],PostData:{PageNumber:1,PageSize:5,nature:1,StockType:1},dataSource:[],selectedRowDatas:[],stockListData:[],reload:!1},t}return _inherits(StockAdd,e),C(StockAdd,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,a=e.getStockListResult,l=e.createStockResult;a!==t.getStockListResult&&this.setState({stockListData:a.Data}),l!==t.createStockResult&&200===l.Status&&w.browserHistory.push("/operation/stock/list")}},{key:"render",value:function(){var e=this,t=this.state.stockType,a=[{title:"库存编号",dataIndex:"Id"},{title:"库存名称",dataIndex:"Name"},{title:"库存面值",width:70,dataIndex:"FaceValue"}],l=[{title:"库存编号",dataIndex:"Id"},{title:"库存名称",dataIndex:"Name"},{title:"库存面值",dataIndex:"FaceValue"},{title:"设置库存优先级",dataIndex:"CreateTime",render:function(t,a,l){return R.default.createElement("div",null,R.default.createElement(m.default,{placeholder:"设置库存优先级",onChange:function(t){e.setClass(t,a.Id)}}))}},{title:"操作",width:50,render:function(t,a,l){return R.default.createElement("div",null,R.default.createElement("span",{style:{paddingRight:"15px"}},R.default.createElement(P.default,{title:"删除",glyphIcon:D.iDelete,click:function(){e.removeSetClass(l,a.Id)}})))}}],n=this.state.selectedRowKeys,o=this.props.form.getFieldDecorator,u=this.props.isfetching,f={selectedRowKeys:n,onChange:function(t,a){e.setState({selectedRowKeys:t});var l=e.state.selectedRowDatas,r=[];e.state.stockPackListData;for(var n in t){for(var s in l){if(t[n]==l[s].Id){r.push(l[s]);break}if(l.length-1==s)for(var o in a)if(a[o].Id==t[n]){r.push(a[o]);break}}if(l.length<1)for(var i in a)if(a[i].Id==t[n]){r.push(a[i]);break}}l=r,e.setState({selectedRowDatas:l})}},d=this.props.getStockListResult.Total,p={total:d,showSizeChanger:!1,pageSize:this.state.PostData.PageSize,onChange:function(t,a){var l=e.state.PostData;Object.assign({},e.state.PostData),l.PageNumber=t,e.props.getStockList(l),e.setState({reload:!0})}};return R.default.createElement("div",null,R.default.createElement(r.default,{spinning:u},R.default.createElement(y.default,{style:{marginBottom:10}},R.default.createElement(I,{label:"库存名称",labelCol:{span:2},wrapperCol:{span:12}},o("Name",{initialValue:"",rules:[{required:!0,message:"请输入库存名称"}]})(R.default.createElement(m.default,null))),R.default.createElement(I,{label:"库存性质",labelCol:{span:2},wrapperCol:{span:12}},o("Nature",{initialValue:"1"})(R.default.createElement(k.default,{id:"select",size:"large",onChange:this.handleSelectChange},R.default.createElement(T,{value:"1"},"普通库存"),R.default.createElement(T,{value:"2"},"库存包"),R.default.createElement(T,{value:"3"},"区域库存")))),1==this.state.stockType.length&&"卡密"==this.state.stockType[0]?R.default.createElement(i.default,{className:"pb20"},R.default.createElement(c.default,{span:12,offset:2},R.default.createElement(i.default,{style:{marginBottom:"10px"}},R.default.createElement(c.default,{span:3,style:{lineHeight:"30px"}},"库存名称"),R.default.createElement(c.default,{span:10},o("selectStockName",{initialValue:this.state.PostData.name})(R.default.createElement(m.default,null))),R.default.createElement(c.default,{span:4},R.default.createElement(b.default,{type:"primary",className:"ml10",htmlType:"button",onClick:this.selectStock},"筛选")),R.default.createElement(c.default,{span:7,style:{textAlign:"right"}},R.default.createElement(b.default,{type:"default",htmlType:"button",onClick:this.displayAllStock},"显示全部卡密库存"))),R.default.createElement(s.default,{rowKey:"Id",rowSelection:f,columns:a,pagination:p,dataSource:this.state.stockListData,className:"mb10"}),R.default.createElement(s.default,{rowKey:"Id",columns:l,dataSource:this.state.selectedRowDatas||[],pagination:!1,locale:{emptyText:"您还没有选择库存"}}))):"",R.default.createElement(I,{label:"库存类型",labelCol:{span:2},wrapperCol:{span:12}},o("Type",{initialValue:"卡密"===this.state.stockTypeVal?"1":"2"})(R.default.createElement(k.default,{id:"select",size:"large",onChange:this.handleSelectStockTypeValChange},t.map(function(e,t){return R.default.createElement(T,{key:t,value:"卡密"===e?"1":"2"},e)})))),1==this.state.stockType.length&&"卡密"==this.state.stockType[0]?"":R.default.createElement(I,{label:"库存面值",labelCol:{span:2},wrapperCol:{span:12}},o("FaceValue",{initialValue:"",rules:[{required:!0,message:"请输入库存面值"},{pattern:/^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$/,message:"库存面值只能输入数字，请重新输入"}]})(R.default.createElement(m.default,null))),2!==this.state.stockType.length?"":R.default.createElement(I,{label:"报警数量",labelCol:{span:2},wrapperCol:{span:12}},o("WarningCount",{initialValue:"",rules:[{required:!0,message:"请输入报警数量"},{pattern:/^[1-9]\d*$/,message:"报警数量只能输入数字，请重新输入"}]})(R.default.createElement(m.default,null))),R.default.createElement(I,{label:"备注说明",labelCol:{span:2},wrapperCol:{span:12}},o("Remark",{initialValue:""})(R.default.createElement(m.default,{type:"textarea",rows:4}))),R.default.createElement(I,{wrapperCol:{span:6,offset:2}},R.default.createElement(b.default,{type:"primary",htmlType:"button",size:"large",onClick:this.sibmitData},"提交")))))}}]),StockAdd}(R.default.Component);t.default=L()(q),e.exports=t.default}});