webpackJsonp([15],{1498:function(e,t,a){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),i=a(0),l=_interopRequireDefault(i),r=a(31),o=a(1666),s=_interopRequireDefault(o);a(1693);var u=function(e){function Login(){return _classCallCheck(this,Login),_possibleConstructorReturn(this,(Login.__proto__||Object.getPrototypeOf(Login)).apply(this,arguments))}return _inherits(Login,e),n(Login,[{key:"render",value:function(){return l.default.createElement("div",{className:"sign"},l.default.createElement("div",{className:"header"},l.default.createElement("div",{className:"inner"},l.default.createElement("h1",{className:"logo-wrap"},l.default.createElement(r.IndexLink,{className:"logo",to:"/login"},l.default.createElement("span",null,"卡仓网"))))),l.default.createElement("div",{className:"container"},l.default.createElement("div",{className:"inner"},l.default.createElement(s.default,null))),l.default.createElement("div",{className:"footer"},l.default.createElement("div",{className:"inner"},l.default.createElement("p",{className:"copyright"},"Copyright © 2009-2016 ",l.default.createElement("a",{href:"http://www.fulu.com/",target:"_black"},"武汉福禄网络科技有限公司")," All Rights Reserved."),l.default.createElement("p",{className:"id"},l.default.createElement("span",null,"互联网文化经营许可证号：",l.default.createElement("a",{href:"http://sq.ccm.gov.cn/ccnt/sczr/service/business/emark/toDetail/dc591ebe583844c9970adbc286318d23"},"鄂网文〔2016〕1125-021号")),l.default.createElement("span",{className:"divider"},"|"),l.default.createElement("span",null,"IP 备案： 鄂 B2-20130116"),l.default.createElement("span",{className:"divider"},"|"),l.default.createElement("span",null,"ICP 电信增值： 鄂 ICP10020006")),l.default.createElement("p",{className:"search"},l.default.createElement("a",{href:"#"},l.default.createElement("img",{src:"http://www.fulu.com/img/law2.png"}),"互联网违法信息查询-12377"),l.default.createElement("span",{className:"divider"},"|"),l.default.createElement("a",{href:"#"},l.default.createElement("img",{src:"http://www.fulu.com/img/law3.png"}),"可信网站查询"),l.default.createElement("span",{className:"divider"},"|"),l.default.createElement("a",{href:"#"},l.default.createElement("img",{src:"http://www.fulu.com/img/law1.png"}),"工商证件查询")))))}}]),Login}(i.Component);t.default=u,e.exports=t.default},1637:function(e,t,a){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n,i,l,r=(a(114),a(113)),o=_interopRequireDefault(r),s=(a(67),a(60)),u=_interopRequireDefault(s),c=(a(571),a(217)),d=_interopRequireDefault(c),f=(a(112),a(165)),m=_interopRequireDefault(f),h=(a(78),a(77)),p=_interopRequireDefault(h),g=function(){function defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),C=a(0),v=_interopRequireDefault(C),w=a(31),E=a(339),y=_interopRequireDefault(E),b=a(4),k=_interopRequireDefault(b),S=a(322),x=_interopRequireDefault(S),P=a(173),_=_interopRequireDefault(P),N=p.default.Item,R=60,D=(i=n=function(e){function LoginForm(e){_classCallCheck(this,LoginForm);var t=_possibleConstructorReturn(this,(LoginForm.__proto__||Object.getPrototypeOf(LoginForm)).call(this,e));return l.call(t),t.state={errnum:0,isValidWeChat:!1,validWeChatError:!1,telValid:!1,wechatCode:"",one:"",two:"",three:"",four:"",time:R,timeStr:R+"s重新获取",tel:"",validateStatus:"",info:""},t.weixinCode="",t}return _inherits(LoginForm,e),g(LoginForm,[{key:"componentWillMount",value:function(){localStorage.clear()}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"componentWillReceiveProps",value:function(e){var t=e.checkLoginResult;e.wechatResult,e.validWeixinResult,e.authorizationResult,e.validPhoneCodeResult,e.getSubAccountPermissionListExtendResult;if(t!==this.props.checkLoginResult){if(500!==t.Status||"AS001001001"!==t.ErrorCode&&"FS001001004"!==t.ErrorCode)if(500===t.Status&&"FS001001006"===t.ErrorCode){if(t.Data.OpenId){localStorage.setItem("token",t.Data.Token);var a=t.Data.OpenId,n=t.Data.UserName;window.location.href=window.location.origin+"/confirmWait?openId="+a+"&userName="+n+"&status=true"}}else if(500===t.Status&&"FS001001007"===t.ErrorCode){if(t.Data.OpenId){localStorage.setItem("token",t.Data.Token);var i=t.Data.OpenId,l=t.Data.UserName;window.location.href=window.location.origin+"/confirmWait?openId="+i+"&userName="+l+"&status=true&type=1"}}else 500===t.Status&&"FS001001002"===t.ErrorCode&&this.setState({validateStatus:"error",info:"用户名或密码有误"});else if(t.Data.OpenId){localStorage.setItem("token",t.Data.Token);var r=t.Data.OpenId,o=t.Data.UserName;window.location.href=window.location.origin+"/confirmation?openId="+r+"&userName="+o}200===t.Status&&(localStorage.setItem("token",t.Data.Token),localStorage.setItem("openId",t.Data.OpenId),w.browserHistory.push("/"))}}},{key:"render",value:function(){var e=this,t=this.state,a=t.validateStatus,n=t.info,i=this.props,l=i.form.getFieldDecorator,r=_.default.LOGIN+"/passport/register?returnUrl="+encodeURIComponent(window.location.origin+"/confirmation")+"&clientId=88888888";return v.default.createElement("div",{className:"sign-form"},v.default.createElement(o.default,{spinning:this.props.isfetching},!this.state.isValidWeChat&&!this.state.telValid&&v.default.createElement("div",null,v.default.createElement("div",{className:"sign-form-hd"},v.default.createElement("h3",null,"用户登录")),v.default.createElement("div",{className:"sign-form-bd"},v.default.createElement(p.default,{horizontal:!0},v.default.createElement(N,{validateStatus:a,help:""!==n?n:"",hasFeedback:!0},l("username",{rules:[{required:!0,message:"请输入用户名"},{validator:this.checkUserConfirm}],initialValue:""})(v.default.createElement(m.default,{placeholder:"用户名"}))),v.default.createElement(N,{hasFeedback:!0},l("password",{rules:[{required:!0,message:"请输入密码"}],initialValue:""})(v.default.createElement(m.default,{type:"password",placeholder:"密码"}))),this.state.errnum>=3&&v.default.createElement(N,{hasFeedback:!0},l("verifycode",{rules:[{required:!0,message:"验证码"}],initialValue:""})(v.default.createElement(m.default,{type:"text",placeholder:"验证码",addonAfter:v.default.createElement("img",{src:this.state.verifycodeUrl,title:"点击刷新验证码",onClick:this.verifycodeChange})}))),v.default.createElement(N,{className:"clearfix"},v.default.createElement("div",{className:"pull-left"},l("agreement",{valuePropName:"checked",initialValue:!0})(v.default.createElement(d.default,null,"我已阅读 ",v.default.createElement("a",{href:"javascript:;"},"《卡仓网用户协议》")))),v.default.createElement("div",{className:"pull-right"},v.default.createElement("a",{href:r,className:"mr10"},"注册"),v.default.createElement("a",{href:x.default.PATH.FindPassword},"找回密码"))),v.default.createElement(N,null,v.default.createElement(u.default,{className:"ant-btn-block",type:"primary",htmlType:"submit",onClick:this.handleSubmit},"登录"))))),this.state.isValidWeChat&&!this.state.validWeChatError&&v.default.createElement("div",null,v.default.createElement("div",{className:"login-detail"},v.default.createElement("div",{className:"m10"},v.default.createElement("div",null,v.default.createElement("span",null,"验证码已发送到您的微信号!"),v.default.createElement("button",{className:"pl10 text-blue sendweixinbtn",onClick:this.sendWeiXinCodeClick},this.state.timeStr)),v.default.createElement("div",{className:"mb10"},"请输入验证码:"),v.default.createElement("div",null,v.default.createElement("input",{onChange:this.change,onKeyDown:this.oneKeyDown,onClick:this.wechatInputClick,ref:function(t){e.one=t},type:"text",className:"weixinValidateSub"}),v.default.createElement("input",{onChange:this.change,onKeyDown:this.oneKeyDown,onClick:this.wechatInputClick,ref:function(t){e.two=t},type:"text",className:"weixinValidateSub"}),v.default.createElement("input",{onChange:this.change,onKeyDown:this.oneKeyDown,onClick:this.wechatInputClick,ref:function(t){e.three=t},type:"text",className:"weixinValidateSub"}),v.default.createElement("input",{onChange:this.change,onKeyDown:this.oneKeyDown,onClick:this.wechatInputClick,ref:function(t){e.four=t},type:"text",className:"weixinValidateSub"}))),v.default.createElement("div",{className:"p10"},v.default.createElement("a",{href:"javascript:;",onClick:this.switchPhone,className:"text-red",id:"showPhoneCodeWrap"},"微信无法使用?")))),this.state.validWeChatError&&v.default.createElement("div",null,"验证码错误，系统禁止进入（3s后重新输入）"),this.state.telValid&&!this.state.validWeChatError&&v.default.createElement("div",{className:"m10"},v.default.createElement("div",null,"向此账号绑定的唯一手机号发送登录验证码"),v.default.createElement("div",{className:"mb10"},this.state.tel),v.default.createElement("div",null,v.default.createElement("input",{type:"text",onChange:this.onPhoneChange,className:"telCode",style:{width:"150px"},placeholder:"验证码"}),v.default.createElement("a",{href:"javascript:;",className:"pl10",onClick:this.sendPhoneCodeClick},this.state.timeStr)),v.default.createElement("div",{style:{borderTop:"1px #e7e7e7 solid",marginTop:"20px"},className:"p10"},"手机号已不能使用？",v.default.createElement("a",{href:"javascript:;",className:"text-blue"},"账号申述?")))))}}]),LoginForm}(C.Component),n.propTypes={form:k.default.shape({validateFields:k.default.func.isRequired,getFieldDecorator:k.default.func.isRequired,resetFields:k.default.func.isRequired,setFieldsValue:k.default.func.isRequired}).isRequired,checkLogin:k.default.func.isRequired,isfetching:k.default.bool.isRequired,checkLoginResult:k.default.shape({Status:k.default.number.isRequired})},n.defaultProps={checkLoginResult:void 0,isfetching:!1},l=function(){var e=this;this.sendWeiXinCode=function(){e.timer&&clearInterval(e.timer),e.timer=setInterval(function(){e.setState({time:e.state.time-=1,timeStr:e.state.time+"s重新获取"}),e.state.time<=0&&(clearInterval(e.timer),e.setState({time:R,timeStr:"获取验证码"}))},1e3)},this.sendWeiXinCodeClick=function(){e.state.time===R&&(e.props.sendWechatVerifyCode(),e.sendWeiXinCode())},this.sendPhoneCodeClick=function(){e.state.time===R&&(e.props.sendPhoneVerifyCode(),e.sendWeiXinCode())},this.onPhoneChange=function(t){4==t.target.value.length&&(e.props.validPhoneVerifyCode(t.target.value),t.target.value="")},this.verifycodeChange=function(){var t={verifycodeUrl:localStorage.getItem("PassportDomain")+"handler/ValidationCode.ashx?time="+(new Date).toTimeString()};e.setState(t)},this.validWeixin=function(){e.one.focus()},this.wechatCodeChange=function(t){e.setState({wechatCode:t.target.value})},this.wechatInputClick=function(){e.setFocus()},this.oneKeyDown=function(t){if(t.target.value&&8!==t.keyCode)return t.preventDefault();8===t.keyCode&&(e.weixinCode=e.weixinCode.substr(0,e.weixinCode.length-1),e.setFocus())},this.setFocus=function(){0===e.weixinCode.length?e.one.focus():1===e.weixinCode.length?e.two.focus():2===e.weixinCode.length?e.three.focus():3===e.weixinCode.length?e.four.focus():(e.props.validWeixin(e.weixinCode),e.weixinCode="")},this.handleSubmit=function(){e.props.form.validateFields(function(t,a){if(!t){var n=new y.default.JSEncrypt;n.setPublicKey("MIIBOAIBAAJAZe0dPjf3UzFUoLI8frCJuLjG5g+hX+M9uBHC2b49pd4oyH7icsxleyixTzZABhEx5+gJjpwI/ZQSnzdqWeY4bwIDAQABAkBW3eSkWDJTFqHXatAf8PkPE3uAKyYPgK3jKE/2HyqPJ1mjlFfShoOwe0bixOpFw9ug+fpPNhDGTsjrntZBG0vxAiEAq75BxA4YetwEXptxoPUQPbs2VAWPc9rOufmnz44owOUCIQCX7lXRE7QsE68AKh720RCkEldwLJnHNkxP3PTvP9uCwwIgU244iqKCV+TcJo2C9Ls4KZTxvn15A8IO3R+f2t9ngtUCIAd6ierix2msBl9Bs4h+vgz1gixZZbByscr0m3HzeMC1AiBwlQmSnT7xq5YsnjJODIE2/UgirQ+oKJlzpBqVqE5+pw=="),e.loginData={UserName:a.username,Pwd:encodeURIComponent(n.encrypt(a.password))},e.props.checkLogin(e.loginData)}})},this.change=function(t){e.weixinCode+=t.target.value,e.setFocus()},this.switchPhone=function(){e.timer&&clearInterval(e.timer),e.setState({telValid:!0,isValidWeChat:!1,time:R,timeStr:"获取验证码"}),e.sendPhoneCodeClick()},this.checkUserConfirm=function(t,a,n){""===a?e.setState({validateStatus:"error",info:"请输入用户名"}):e.setState({validateStatus:"success",info:""}),n()}},i);t.default=p.default.create()(D),e.exports=t.default},1666:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(30),i=(a(566),a(1637)),l=function(e){return e&&e.__esModule?e:{default:e}}(i),r=a(80),o=function(e){return{checkLoginResult:e.account.checkLoginResult,getCurrentResult:e.account.getCurrentResult,getSubAccountPermissionListExtendResult:e.account.getSubAccountPermissionListExtendResult,isfetching:e.account.isfetching}};t.default=(0,n.connect)(o,{checkLogin:r.checkLogin,getCurrent:r.getCurrent,getSubAccountPermissionListExtend:r.getSubAccountPermissionListExtend})(l.default),e.exports=t.default},1693:function(e,t){}});